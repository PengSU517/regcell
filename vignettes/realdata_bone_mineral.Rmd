---
title: "Bone mineral dataset"
author: "pengsu"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```




```{r}
dat = data("datascreen_corh", package = "regcell")

y = dat[,1] # t-bone scores
x = as.matrix(dat[,2:101]) # gene expression

set.seed(1)
inTrain <- caret::createDataPartition(y, p = 0.7)[[1]]


ytrain = y[inTrain]
xtrain = x[inTrain,]

ytest = y[-inTrain]
xtest = x[-inTrain,]


fit0 = sregcell_std(ytrain,xtrain, penal = 1, softbeta = T, prob = 0.995, softzeta = 1, maxiter = 30)
res = ytest - fit0$intercept_hat - xtest%*%fit0$betahat

hist(res, main = "Prediction errors form the test set")

```


