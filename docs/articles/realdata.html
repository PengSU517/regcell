<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="regcell">
<title>Bone mineral density data â€¢ regcell</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bone mineral density data">
<meta property="og:description" content="regcell">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">regcell</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/demo.html">Quick demo</a>
    <a class="dropdown-item" href="../articles/realdata.html">Bone mineral density data</a>
    <a class="dropdown-item" href="../articles/simu.html">Simulations</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bone mineral density data</h1>
            
      
      
      <div class="d-none name"><code>realdata.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remotes::install_github("PengSU517/regcell")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pengsu517.github.io/regcell/">regcell</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span></span></code></pre></div>
<p>To illustrate the use of CR-Lasso, we consider the bone mineral density (BMD) data from <span class="citation">Reppe et al. (2010)</span>.
The data are publicly available in the <a href="https://www.ebi.ac.uk/arrayexpress/experiments/E-MEXP-1618" class="external-link">European Bioinformatics Institute Array-Express repository</a>.
The BMD data consists of gene expression measurements of 54,675 probes of 84 Norwegian women.</p>
<p>Microarray measurements are often contaminated (noisy), as <span class="citation">Rocke &amp; Durbin (2001)</span> highlighted. This contamination can stem from multiple sources, thereby obscuring the gene expression in the data <span class="citation">(Zakharkin et al., 2005)</span>.</p>
<div class="section level2">
<h2 id="importing-the-data">Importing the data<a class="anchor" aria-label="anchor" href="#importing-the-data"></a>
</h2>
<p>Direct links to the data files:</p>
<ul>
<li><a href="https://www.ebi.ac.uk/biostudies/files/E-MEXP-1618/Normarrayexpressdata.txt.magetab" class="external-link">Normarrayexpressdata.txt.magetab</a></li>
<li><a href="https://www.ebi.ac.uk/biostudies/files/E-MEXP-1618/E-MEXP-1618.sdrf.txt" class="external-link">E-MEXP-1618.sdrf.txt</a></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## array expression data</span></span>
<span><span class="va">expressiondat</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"Normarrayexpressdata.txt.magetab"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/row_to_names.html" class="external-link">row_to_names</a></span><span class="op">(</span>row_number <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html" class="external-link">parse_number</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">composite_element_ref</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, .fns <span class="op">=</span> <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, .fns <span class="op">=</span> <span class="va">log</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># feature data</span></span>
<span><span class="va">featuredat</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html" class="external-link">read_tsv</a></span><span class="op">(</span><span class="st">"E-MEXP-1618.sdrf.txt"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>id <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/parse_number.html" class="external-link">parse_number</a></span><span class="op">(</span><span class="va">source_name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>,</span>
<span>                hip_t <span class="op">=</span> <span class="va">characteristics_total_hip_t_score</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">id</span><span class="op">)</span> <span class="co"># sort obs by patient ID</span></span>
<span></span>
<span><span class="co"># merged data</span></span>
<span><span class="va">datall</span> <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">featuredat</span>, <span class="va">expressiondat</span>, </span>
<span>                          by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">write_rds</a></span><span class="op">(</span><span class="va">datall</span>, file <span class="op">=</span> <span class="st">"datall.rds"</span>, compress <span class="op">=</span> <span class="st">"gz"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="feature-screening">Feature screening<a class="anchor" aria-label="anchor" href="#feature-screening"></a>
</h2>
<p>Given the large number of variables in the dataset, a pre-screening step was implemented to identify the subset of variables that are most correlated with the outcome of interest, the total hip T-score.
To accomplish this, we first log-transformed all the predictors and then utilized the robust correlation estimate based on Winsorization as in <span class="citation">Khan et al. (2007)</span>, instead of the Pearson correlation, since Winsorization is more robust to outliers that may occur in the dataset.
The screened data comprise measurements of <span class="math inline">\(p = 100\)</span> genes from <span class="math inline">\(n = 84\)</span> Norwegian women.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datall</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"datall.rds"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">datall</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span>, <span class="op">-</span><span class="va">hip_t</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">datall</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">hip_t</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># Huber correlation</span></span>
<span><span class="va">corh</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>,</span>
<span>             FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">xvec</span><span class="op">)</span><span class="op">{</span><span class="fu">robustHD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustHD/man/corHuber.html" class="external-link">corHuber</a></span><span class="op">(</span><span class="va">xvec</span>, <span class="va">y</span><span class="op">)</span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="va">orders</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">corh</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">xscreen</span> <span class="op">=</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span>,<span class="va">orders</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span>
<span><span class="co"># pairs(cbind(y,xscreen[,1:5]))</span></span>
<span><span class="va">datascreen</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">xscreen</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">datascreen</span><span class="op">)</span> <span class="op">=</span> <span class="va">datall</span><span class="op">$</span><span class="va">id</span></span>
<span><span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">write_rds</a></span><span class="op">(</span><span class="va">datascreen</span>, file <span class="op">=</span> <span class="st">"datascreen.rds"</span><span class="op">)</span></span></code></pre></div>
<p>The screened data, <code>datascreen</code>, is included in the <code>regcell</code> package.</p>
<p>The plot below shows the outlier cell map for 100 screened variables on 84 Norwegian women using the DDC method <span class="citation">Rousseeuw &amp; Van Den Bossche (2018)</span>.
Cells are flagged as outlying if the observed and predicted values differ too much.
Most cells are blank, showing they are not detected as outliers.
A red cell means the observed value is significantly higher than the predicted value, and a blue cell means the observed value is significantly lower.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">datascreen</span>, package <span class="op">=</span> <span class="st">"regcell"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">datascreen</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">cellWise</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cellWise/man/DDC.html" class="external-link">DDC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt;  The input data has 84 rows and 100 columns.</span></span>
<span><span class="fu">regcell</span><span class="fu">::</span><span class="fu"><a href="../reference/newcellmap.html">newcellmap</a></span><span class="op">(</span></span>
<span>  <span class="va">fit1</span><span class="op">$</span><span class="va">stdResid</span>,</span>
<span>  columnlabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">" "</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  rowlabels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">" "</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  columnangle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  colContrast <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rowtitle <span class="op">=</span> <span class="st">"Observations"</span>, columntitle <span class="op">=</span> <span class="st">"Genes"</span>,</span>
<span>  sizetitles <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  adjustrowlabels <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  adjustcolumnlabels <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span>,</span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">14</span><span class="op">)</span>, <span class="co">#change legend title font size</span></span>
<span>        legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:fig-outliervis"></span>
<img src="realdata_files/figure-html/fig-outliervis-1.png" alt="Outlier cell map for 100 screened variables on 84 Norwegian women. Cells are flagged as outlying if the observed and predicted values differ too much. Most cells are blank, showing they are not detected as outliers. A red cell means the observed value is significantly higher than the predicted value, and a blue cell means the observed value is significantly lower."><p class="caption">
Figure 1: Outlier cell map for 100 screened variables on 84 Norwegian women. Cells are flagged as outlying if the observed and predicted values differ too much. Most cells are blank, showing they are not detected as outliers. A red cell means the observed value is significantly higher than the predicted value, and a blue cell means the observed value is significantly lower.
</p>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall average contamination rate</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">fit1</span><span class="op">$</span><span class="va">Ximp</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.03607143</span></span>
<span></span>
<span><span class="co"># Column average</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">fit1</span><span class="op">$</span><span class="va">Ximp</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.0952381</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">fit1</span><span class="op">$</span><span class="va">Ximp</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; 236831_at </span></span>
<span><span class="co">#&gt;        36</span></span>
<span></span>
<span><span class="co"># Row average</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">fit1</span><span class="op">$</span><span class="va">Ximp</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.22</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">fit1</span><span class="op">$</span><span class="va">Ximp</span><span class="op">)</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 13</span></span></code></pre></div>
<p>On average, the screened genes exhibit an overall contamination rate of 3.6%, with probe 36831_at having the highest contamination rate of 9.5%.
Among the observations, row 13 in Figure <a href="#fig:fig-outliervis">1</a>, with patient ID , shows the highest contamination rate at 22%.</p>
<p>Given the cellwise contamination, we first standardized all variables with the median and <span class="math inline">\(Q_n\)</span>. We then conducted a simple simulation study to validate the effectiveness of CR-Lasso, Lasso, MM-Lasso, RLars, SLTS and SSS on the bone mineral density data.</p>
</div>
<div class="section level2">
<h2 id="method-comparison">Method comparison<a class="anchor" aria-label="anchor" href="#method-comparison"></a>
</h2>
<p>To perform the method comparison considered in the paper, you will need some additional packages. For ease of replication we have created a <code>shootings</code> package. The functions in this package were taken from <a href="https://github.com/ineswilms/sparse-shooting-S" class="external-link uri">https://github.com/ineswilms/sparse-shooting-S</a> and compiled into a basic package to make them more convenient to use:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"PengSU517/shootings"</span><span class="op">)</span></span></code></pre></div>
<p>Another package you may want to use is the <code>mmlasso</code> package. The original code was from <a href="https://github.com/esmucler/mmlasso" class="external-link uri">https://github.com/esmucler/mmlasso</a>.<br>
An adapted version of this package is available from <a href="https://github.com/PengSU517/mmlasso" class="external-link uri">https://github.com/PengSU517/mmlasso</a>, as we found some components no longer functioning as intended.</p>
<p>You can install this package conveniently using :</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"PengSU517/mmlasso"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># remotes::install_github("PengSU517/mmlasso")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mmlasso</span><span class="op">)</span></span>
<span><span class="co"># remotes::install_github("PengSU517/shootings")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">shootings</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com" class="external-link">gt</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">##### methods compared</span></span>
<span><span class="va">mtds</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="co">## spase shooting S, codes are from https://github.com/ineswilms/sparse-shooting-S </span></span>
<span>  <span class="co">## package is available from https://github.com/PengSU517/shootings</span></span>
<span>  <span class="co">## install this package directly using remotes::install_github("PengSU517/shootings")</span></span>
<span>  sss <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">shootings</span><span class="fu">::</span><span class="fu">sparseshooting</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span><span class="op">}</span>,</span>
<span>  </span>
<span>  <span class="co">## Rlars, from package robustHD</span></span>
<span>  rlars <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">regcell</span><span class="fu">::</span><span class="fu"><a href="../reference/Rlars.html">Rlars</a></span><span class="op">(</span><span class="va">y</span>, <span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">betahat</span><span class="op">}</span>, </span>
<span></span>
<span>  <span class="co">## MM-Lasso, forked from https://github.com/esmucler/mmlasso</span></span>
<span>  <span class="co">## the updated package is available from https://github.com/PengSU517/mmlasso</span></span>
<span>  <span class="co">## install this package directly using remotes::install_github("PengSU517/mmlasso")</span></span>
<span>  <span class="co">## the pense package on CRAN would be an alternative here</span></span>
<span>  mmlasso <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">mmlasso</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mmlasso/man/mmlasso.html" class="external-link">mmlasso</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">coef.MMLasso.ad</span><span class="op">}</span>,</span>
<span>  </span>
<span>  <span class="co">## sparse LTS, from package robustHD</span></span>
<span>  slts <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu">robustHD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustHD/man/sparseLTS.html" class="external-link">sparseLTS</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span><span class="op">}</span>,</span>
<span>  </span>
<span>  <span class="co">## cellwise regularized Lasso without post regression, not used in simulations</span></span>
<span>  <span class="co"># cell_lasso = function(y,x){ </span></span>
<span>  <span class="co">#   fit = regcell::sregcell_std(y = y, x = x, softbeta = TRUE, lambda_zeta = 1, penal = 1, penaldelta =0)</span></span>
<span>  <span class="co">#   return(c(fit$intercept_hat, fit$betahat))</span></span>
<span>  <span class="co"># },</span></span>
<span></span>
<span>  <span class="co">## cellwise regularized Lasso with post regression</span></span>
<span>  cell_lasso_post <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">fit</span> <span class="op">=</span> <span class="fu">regcell</span><span class="fu">::</span><span class="fu"><a href="../reference/sregcell_std.html">sregcell_std</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span>, softbeta <span class="op">=</span> <span class="cn">TRUE</span>, lambda_zeta <span class="op">=</span> <span class="fl">1</span>, penal <span class="op">=</span> <span class="fl">1</span>, penaldelta <span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">intercept_hat_post</span>, <span class="va">fit</span><span class="op">$</span><span class="va">betahat_post</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span></span>
<span>  <span class="co">## Lasso, from package glmnet</span></span>
<span>  lasso  <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span><span class="op">{</span> </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">regcell</span><span class="fu">::</span><span class="fu"><a href="../reference/lassocv.html">lassocv</a></span><span class="op">(</span><span class="va">y</span>,<span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">betahat</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="artifically-generated-response">Artifically generated response<a class="anchor" aria-label="anchor" href="#artifically-generated-response"></a>
</h2>
<p>We first obtained a clean (imputed) dataset <span class="math inline">\(\mathbf{\check X}\)</span> using DDC <span class="citation">(Rousseeuw &amp; Van Den Bossche, 2018)</span>. We then generated an artificial response <span class="math inline">\(\mathbf{y} = \mathbf{\check X}\mathbf{\beta} + \mathbf{\varepsilon}\)</span> using screened clean predictors and <span class="math inline">\(\mathbf{\varepsilon} \sim N(\mathbf{0},0.5^2\mathbf{I})\)</span>. We randomly picked ten active predictors in each simulation run and set <span class="math inline">\(\beta_j \sim U(1, 1.5)\)</span> for each of them. We then randomly collected 80% observations from the original (contaminated) dataset for model training, while the remaining 20% of the imputed (clean) dataset was used to assess the prediction accuracy. We repeated the simulation procedure 200 times.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span>cores<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/foreach/man/getDoParWorkers.html" class="external-link">getDoParWorkers</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">datascreen</span>, package <span class="op">=</span> <span class="st">"regcell"</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">robustHD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustHD/man/standardize.html" class="external-link">robStandardize</a></span><span class="op">(</span><span class="va">datascreen</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ximp</span> <span class="op">=</span> <span class="fu">cellWise</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cellWise/man/DDC.html" class="external-link">DDC</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">$</span><span class="va">Ximp</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>mtd <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mtds</span><span class="op">)</span>,</span>
<span>                  .packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"robustHD"</span>, <span class="st">"robustbase"</span> , <span class="st">"mmlasso"</span>, </span>
<span>                                <span class="st">"shootings"</span>, <span class="st">"cellWise"</span>, <span class="st">"regcell"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>pr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>sigma <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>m <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span> <span class="op">{</span> <span class="co"># was 200</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span>    <span class="va">error</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">84</span>, sd <span class="op">=</span> <span class="va">sigma</span><span class="op">)</span></span>
<span>    <span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">pr</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span><span class="op">-</span><span class="va">pr</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">y</span> <span class="op">=</span> <span class="va">ximp</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">beta</span> <span class="op">+</span> <span class="va">error</span></span>
<span>    <span class="va">obs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">84</span>, <span class="fl">17</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">ytrain</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="va">xtrain</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">obs</span>,<span class="op">]</span></span>
<span>    <span class="va">ytest</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="va">xtest</span> <span class="op">=</span> <span class="va">ximp</span><span class="op">[</span><span class="va">obs</span>,<span class="op">]</span></span>
<span></span>
<span>    <span class="va">betahat</span> <span class="op">=</span> <span class="va">mtds</span><span class="op">[[</span><span class="va">mtd</span><span class="op">]</span><span class="op">]</span><span class="op">(</span><span class="va">ytrain</span>,<span class="va">xtrain</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">tpf</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">betahat</span>, <span class="va">beta</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">beta</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">}</span></span>
<span>    <span class="va">tnf</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="va">betahat</span>,<span class="va">beta</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">betahat</span><span class="op">)</span><span class="op">==</span><span class="fu"><a href="https://rdrr.io/r/base/logical.html" class="external-link">as.logical</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">beta</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">}</span></span>
<span>    <span class="va">tp</span> <span class="op">=</span> <span class="fu">tpf</span><span class="op">(</span><span class="va">betahat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">beta</span><span class="op">)</span></span>
<span>    <span class="va">tn</span> <span class="op">=</span> <span class="fu">tnf</span><span class="op">(</span><span class="va">betahat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>, <span class="va">beta</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">res</span> <span class="op">=</span> <span class="va">ytest</span> <span class="op">-</span> <span class="va">betahat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">xtest</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">betahat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="va">mape</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">rmspe</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">rst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m <span class="op">=</span> <span class="va">m</span>, mtd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtds</span><span class="op">)</span><span class="op">[</span><span class="va">mtd</span><span class="op">]</span>, pr <span class="op">=</span> <span class="va">pr</span>, sigma <span class="op">=</span> <span class="va">sigma</span>,</span>
<span>            tp <span class="op">=</span> <span class="va">tp</span>, tn <span class="op">=</span> <span class="va">tn</span>, rmspe <span class="op">=</span> <span class="va">rmspe</span>, mape <span class="op">=</span> <span class="va">mape</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">rst</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">result</span>, file <span class="op">=</span> <span class="st">"result_realdata_artificial.rds"</span><span class="op">)</span></span></code></pre></div>
<p>For each method, we show MAPE (mean absolute prediction error) and RMSPE values, as well as their True positive numbers (TP), true negative numbers (TN) and F<span class="math inline">\(_1\)</span> scores.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"result_realdata_fakey.rds"</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">mtd</span>, </span>
<span>                         cell_lasso_post <span class="op">=</span> <span class="st">"CR-Lasso"</span>,</span>
<span>                         sss <span class="op">=</span> <span class="st">"SSS"</span>,</span>
<span>                         rlars <span class="op">=</span> <span class="st">"RLars"</span>,</span>
<span>                         mmlasso <span class="op">=</span> <span class="st">"MM-Lasso"</span>,</span>
<span>                         slts <span class="op">=</span> <span class="st">"SLTS"</span>,</span>
<span>                         lasso <span class="op">=</span> <span class="st">"Lasso"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">method</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CR-Lasso"</span>, <span class="st">"SSS"</span>, <span class="st">"RLars"</span>, <span class="st">"MM-Lasso"</span>, <span class="st">"SLTS"</span>, <span class="st">"Lasso"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>, <span class="va">as.numeric</span><span class="op">)</span>, </span>
<span>         TP <span class="op">=</span> <span class="va">tp</span>,</span>
<span>         TN <span class="op">=</span> <span class="va">tn</span>,</span>
<span>         FP <span class="op">=</span> <span class="fl">100</span><span class="op">-</span><span class="va">pr</span><span class="op">-</span><span class="va">TN</span>,</span>
<span>         FN <span class="op">=</span> <span class="va">pr</span> <span class="op">-</span> <span class="va">TP</span>,</span>
<span>         BACC <span class="op">=</span> <span class="op">(</span><span class="va">TP</span><span class="op">/</span><span class="va">pr</span> <span class="op">+</span> <span class="va">TN</span><span class="op">/</span><span class="op">(</span><span class="fl">100</span><span class="op">-</span><span class="va">pr</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>         F1 <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="va">TP</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">TP</span> <span class="op">+</span> <span class="va">FP</span> <span class="op">+</span> <span class="va">FN</span><span class="op">)</span>,</span>
<span>         RMSPE <span class="op">=</span> <span class="va">rmspe</span>,</span>
<span>         MAPE <span class="op">=</span> <span class="va">mape</span><span class="op">)</span><span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">method</span>, <span class="va">RMSPE</span>, <span class="va">MAPE</span>, <span class="va">TP</span>, <span class="va">TN</span>, <span class="va">F1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summ</span> <span class="op">=</span> <span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>  RMSPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">RMSPE</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  MAPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">MAPE</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  TP <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">TP</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  TN <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">TN</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  F1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">F1</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># xtable::xtable(t(summ)) ## this is the table we showed in the manuscript</span></span>
<span><span class="fu">gt</span><span class="fu">::</span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">summ</span><span class="op">)</span></span></code></pre></div>
<div id="vvrrnhjzfr" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#vvrrnhjzfr table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#vvrrnhjzfr thead, #vvrrnhjzfr tbody, #vvrrnhjzfr tfoot, #vvrrnhjzfr tr, #vvrrnhjzfr td, #vvrrnhjzfr th {
  border-style: none;
}

#vvrrnhjzfr p {
  margin: 0;
  padding: 0;
}

#vvrrnhjzfr .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#vvrrnhjzfr .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#vvrrnhjzfr .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#vvrrnhjzfr .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#vvrrnhjzfr .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvrrnhjzfr .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvrrnhjzfr .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#vvrrnhjzfr .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#vvrrnhjzfr .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#vvrrnhjzfr .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#vvrrnhjzfr .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#vvrrnhjzfr .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#vvrrnhjzfr .gt_spanner_row {
  border-bottom-style: hidden;
}

#vvrrnhjzfr .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#vvrrnhjzfr .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#vvrrnhjzfr .gt_from_md > :first-child {
  margin-top: 0;
}

#vvrrnhjzfr .gt_from_md > :last-child {
  margin-bottom: 0;
}

#vvrrnhjzfr .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#vvrrnhjzfr .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#vvrrnhjzfr .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#vvrrnhjzfr .gt_row_group_first td {
  border-top-width: 2px;
}

#vvrrnhjzfr .gt_row_group_first th {
  border-top-width: 2px;
}

#vvrrnhjzfr .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvrrnhjzfr .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#vvrrnhjzfr .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#vvrrnhjzfr .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvrrnhjzfr .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvrrnhjzfr .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#vvrrnhjzfr .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#vvrrnhjzfr .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#vvrrnhjzfr .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#vvrrnhjzfr .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvrrnhjzfr .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvrrnhjzfr .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#vvrrnhjzfr .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#vvrrnhjzfr .gt_left {
  text-align: left;
}

#vvrrnhjzfr .gt_center {
  text-align: center;
}

#vvrrnhjzfr .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#vvrrnhjzfr .gt_font_normal {
  font-weight: normal;
}

#vvrrnhjzfr .gt_font_bold {
  font-weight: bold;
}

#vvrrnhjzfr .gt_font_italic {
  font-style: italic;
}

#vvrrnhjzfr .gt_super {
  font-size: 65%;
}

#vvrrnhjzfr .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#vvrrnhjzfr .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#vvrrnhjzfr .gt_indent_1 {
  text-indent: 5px;
}

#vvrrnhjzfr .gt_indent_2 {
  text-indent: 10px;
}

#vvrrnhjzfr .gt_indent_3 {
  text-indent: 15px;
}

#vvrrnhjzfr .gt_indent_4 {
  text-indent: 20px;
}

#vvrrnhjzfr .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="method">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="RMSPE">RMSPE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="MAPE">MAPE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="TP">TP</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="TN">TN</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="F1">F1</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="method" class="gt_row gt_center">CR-Lasso</td>
<td headers="RMSPE" class="gt_row gt_right">1.43</td>
<td headers="MAPE" class="gt_row gt_right">1.16</td>
<td headers="TP" class="gt_row gt_right">8.66</td>
<td headers="TN" class="gt_row gt_right">76.26</td>
<td headers="F1" class="gt_row gt_right">0.55</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">SSS</td>
<td headers="RMSPE" class="gt_row gt_right">2.40</td>
<td headers="MAPE" class="gt_row gt_right">1.94</td>
<td headers="TP" class="gt_row gt_right">6.55</td>
<td headers="TN" class="gt_row gt_right">75.88</td>
<td headers="F1" class="gt_row gt_right">0.45</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">RLars</td>
<td headers="RMSPE" class="gt_row gt_right">1.73</td>
<td headers="MAPE" class="gt_row gt_right">1.40</td>
<td headers="TP" class="gt_row gt_right">7.92</td>
<td headers="TN" class="gt_row gt_right">77.05</td>
<td headers="F1" class="gt_row gt_right">0.52</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">MM-Lasso</td>
<td headers="RMSPE" class="gt_row gt_right">1.91</td>
<td headers="MAPE" class="gt_row gt_right">1.55</td>
<td headers="TP" class="gt_row gt_right">7.84</td>
<td headers="TN" class="gt_row gt_right">73.49</td>
<td headers="F1" class="gt_row gt_right">0.48</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">SLTS</td>
<td headers="RMSPE" class="gt_row gt_right">2.75</td>
<td headers="MAPE" class="gt_row gt_right">2.22</td>
<td headers="TP" class="gt_row gt_right">6.13</td>
<td headers="TN" class="gt_row gt_right">75.74</td>
<td headers="F1" class="gt_row gt_right">0.41</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">Lasso</td>
<td headers="RMSPE" class="gt_row gt_right">1.64</td>
<td headers="MAPE" class="gt_row gt_right">1.33</td>
<td headers="TP" class="gt_row gt_right">9.31</td>
<td headers="TN" class="gt_row gt_right">67.83</td>
<td headers="F1" class="gt_row gt_right">0.46</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="leave-one-out-cross-validation">Leave-one-out Cross-Validation<a class="anchor" aria-label="anchor" href="#leave-one-out-cross-validation"></a>
</h2>
<p>To demonstrate the performance on the real data, a sparse regression model was fitted separately with the original response (the total hip T-score) via the aforementioned methods. Out of the 100 pre-screened genes, nine genes were commonly chosen by CR-Lasso, Lasso, MM-Lasso, RLars, and SLTS. We ran the Leave-One-Out Cross-Validation to assess the performance of the selected models.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">datascreen</span><span class="op">)</span></span>
<span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="va">datascreen</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu">robustHD</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/robustHD/man/standardize.html" class="external-link">robStandardize</a></span><span class="op">(</span><span class="va">datascreen</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>mtd <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mtds</span><span class="op">)</span>,</span>
<span>                  .packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"robustHD"</span>, <span class="st">"robustbase"</span> , <span class="st">"mmlasso"</span>,</span>
<span>                                <span class="st">"shootings"</span>, <span class="st">"cellWise"</span>, <span class="st">"regcell"</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%:%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">foreach</a></span><span class="op">(</span>obs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">84</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/pkg/foreach/man/foreach.html" class="external-link">%dopar%</a></span><span class="op">{</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span>    <span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">]</span></span>
<span>    <span class="va">ytrain</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="va">xtrain</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">obs</span>,<span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">ytest</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">obs</span><span class="op">]</span></span>
<span>    <span class="va">xtest</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">obs</span>,<span class="op">]</span></span>
<span></span>
<span>    <span class="va">betahat</span> <span class="op">=</span> <span class="va">mtds</span><span class="op">[[</span><span class="va">mtd</span><span class="op">]</span><span class="op">]</span><span class="op">(</span><span class="va">ytrain</span>,<span class="va">xtrain</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">res</span> <span class="op">=</span> <span class="va">ytest</span> <span class="op">-</span> <span class="va">betahat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xtest</span><span class="op">*</span><span class="va">betahat</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">rst</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>mtd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtds</span><span class="op">)</span><span class="op">[</span><span class="va">mtd</span><span class="op">]</span>, n <span class="op">=</span> <span class="va">obs</span>, p <span class="op">=</span> <span class="va">p</span>, res <span class="op">=</span> <span class="va">res</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">rst</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/save.html" class="external-link">save</a></span><span class="op">(</span><span class="va">result</span>, file <span class="op">=</span> <span class="st">"result_realdata.rds"</span><span class="op">)</span></span></code></pre></div>
<p>The RMSPE and MAPE from Leave-one-out prediction residuals are also shown in table.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">=</span> <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/read_rds.html" class="external-link">read_rds</a></span><span class="op">(</span><span class="st">"result_realdata.rds"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, .fns <span class="op">=</span> <span class="va">as.numeric</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html" class="external-link">recode</a></span><span class="op">(</span><span class="va">mtd</span>, </span>
<span>                         cell_lasso_post <span class="op">=</span> <span class="st">"CR-Lasso"</span>,</span>
<span>                         sss <span class="op">=</span> <span class="st">"SSS"</span>,</span>
<span>                         rlars <span class="op">=</span> <span class="st">"RLars"</span>,</span>
<span>                         mmlasso <span class="op">=</span> <span class="st">"MM-Lasso"</span>,</span>
<span>                         slts <span class="op">=</span> <span class="st">"SLTS"</span>,</span>
<span>                         lasso <span class="op">=</span> <span class="st">"Lasso"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">method</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CR-Lasso"</span>, <span class="st">"SSS"</span>, <span class="st">"RLars"</span>, <span class="st">"MM-Lasso"</span>, <span class="st">"SLTS"</span>, <span class="st">"Lasso"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">summ</span> <span class="op">=</span> <span class="va">result</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">method</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>  MSPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>  RMSPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">res</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co">##  should update the manuscript...</span></span>
<span>  MAPE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># xtable::xtable(t(summ)) ## this is the table we showed in the manuscript</span></span>
<span><span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="va">summ</span><span class="op">)</span></span></code></pre></div>
<div id="kxgqdiujyl" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kxgqdiujyl table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kxgqdiujyl thead, #kxgqdiujyl tbody, #kxgqdiujyl tfoot, #kxgqdiujyl tr, #kxgqdiujyl td, #kxgqdiujyl th {
  border-style: none;
}

#kxgqdiujyl p {
  margin: 0;
  padding: 0;
}

#kxgqdiujyl .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kxgqdiujyl .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kxgqdiujyl .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kxgqdiujyl .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kxgqdiujyl .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxgqdiujyl .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxgqdiujyl .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kxgqdiujyl .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kxgqdiujyl .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kxgqdiujyl .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kxgqdiujyl .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kxgqdiujyl .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kxgqdiujyl .gt_spanner_row {
  border-bottom-style: hidden;
}

#kxgqdiujyl .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kxgqdiujyl .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kxgqdiujyl .gt_from_md > :first-child {
  margin-top: 0;
}

#kxgqdiujyl .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kxgqdiujyl .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kxgqdiujyl .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kxgqdiujyl .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kxgqdiujyl .gt_row_group_first td {
  border-top-width: 2px;
}

#kxgqdiujyl .gt_row_group_first th {
  border-top-width: 2px;
}

#kxgqdiujyl .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxgqdiujyl .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kxgqdiujyl .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kxgqdiujyl .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxgqdiujyl .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxgqdiujyl .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kxgqdiujyl .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kxgqdiujyl .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kxgqdiujyl .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kxgqdiujyl .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxgqdiujyl .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxgqdiujyl .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kxgqdiujyl .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kxgqdiujyl .gt_left {
  text-align: left;
}

#kxgqdiujyl .gt_center {
  text-align: center;
}

#kxgqdiujyl .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kxgqdiujyl .gt_font_normal {
  font-weight: normal;
}

#kxgqdiujyl .gt_font_bold {
  font-weight: bold;
}

#kxgqdiujyl .gt_font_italic {
  font-style: italic;
}

#kxgqdiujyl .gt_super {
  font-size: 65%;
}

#kxgqdiujyl .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kxgqdiujyl .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kxgqdiujyl .gt_indent_1 {
  text-indent: 5px;
}

#kxgqdiujyl .gt_indent_2 {
  text-indent: 10px;
}

#kxgqdiujyl .gt_indent_3 {
  text-indent: 15px;
}

#kxgqdiujyl .gt_indent_4 {
  text-indent: 20px;
}

#kxgqdiujyl .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="method">method</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="MSPE">MSPE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="RMSPE">RMSPE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="MAPE">MAPE</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="method" class="gt_row gt_center">CR-Lasso</td>
<td headers="MSPE" class="gt_row gt_right">1.51</td>
<td headers="RMSPE" class="gt_row gt_right">1.23</td>
<td headers="MAPE" class="gt_row gt_right">0.98</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">SSS</td>
<td headers="MSPE" class="gt_row gt_right">2.41</td>
<td headers="RMSPE" class="gt_row gt_right">1.55</td>
<td headers="MAPE" class="gt_row gt_right">1.25</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">RLars</td>
<td headers="MSPE" class="gt_row gt_right">2.20</td>
<td headers="RMSPE" class="gt_row gt_right">1.48</td>
<td headers="MAPE" class="gt_row gt_right">1.20</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">MM-Lasso</td>
<td headers="MSPE" class="gt_row gt_right">1.31</td>
<td headers="RMSPE" class="gt_row gt_right">1.15</td>
<td headers="MAPE" class="gt_row gt_right">0.95</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">SLTS</td>
<td headers="MSPE" class="gt_row gt_right">1.55</td>
<td headers="RMSPE" class="gt_row gt_right">1.25</td>
<td headers="MAPE" class="gt_row gt_right">1.06</td>
</tr>
<tr>
<td headers="method" class="gt_row gt_center">Lasso</td>
<td headers="MSPE" class="gt_row gt_right">0.92</td>
<td headers="RMSPE" class="gt_row gt_right">0.96</td>
<td headers="MAPE" class="gt_row gt_right">0.79</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/boxplot.html" class="external-link">boxplot</a></span><span class="op">(</span><span class="va">res</span><span class="op">~</span><span class="va">method</span>, data <span class="op">=</span> <span class="va">result</span>,  ylab<span class="op">=</span><span class="st">""</span>, xlab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="realdata_files/figure-html/unnamed-chunk-10-1.png" alt="Leave-one-out prediction residuals of the Bone mineral density data"><p class="caption">
Figure 2: Leave-one-out prediction residuals of the Bone mineral density data
</p>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-khan2007robust" class="csl-entry">
Khan, J. A., Van Aelst, S., &amp; Zamar, R. H. (2007). Robust linear model selection based on least angle regression. <em>Journal of the American Statistical Association</em>, 102, 1289â€“1299.
</div>
<div id="ref-reppe2010eight" class="csl-entry">
Reppe, S., Refvem, H., Gautvik, V. T., Olstad, O. K., HÃ¸vring, P. I., Reinholt, F. P., â€¦ Gautvik, K. M. (2010). Eight genes are highly associated with BMD variation in postmenopausal caucasian women. <em>Bone</em>, 46, 604â€“612.
</div>
<div id="ref-rocke2001model" class="csl-entry">
Rocke, D. M., &amp; Durbin, B. (2001). A model for measurement error for gene expression arrays. <em>Journal of Computational Biology</em>, 8, 557â€“569.
</div>
<div id="ref-rousseeuw_detecting_2018" class="csl-entry">
Rousseeuw, P. J., &amp; Van Den Bossche, W. (2018). Detecting deviating data cells. <em>Technometrics</em>, 60, 135â€“145.
</div>
<div id="ref-zakharkin2005sources" class="csl-entry">
Zakharkin, S. O., Kim, K., Mehta, T., Chen, L., Barnes, S., Scheirer, K. E., â€¦ Page, G. P. (2005). Sources of variation in affymetrix microarray experiments. <em>BMC Bioinformatics</em>, 6, 1â€“11.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peng Su, Garth Tarr, Samuel Muller, Suojin Wang.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
